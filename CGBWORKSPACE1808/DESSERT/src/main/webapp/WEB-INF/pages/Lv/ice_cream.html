 <div class="content-box" style="min-height: 146px;">
    <div class="top-load-p" id="list-loading" style="display: none;">加载中……</div>
    <div class="pro-list-content">
        <div class="pro-list-box" style="">
            <ul class="pro-list-pr">
                 
            </ul>
        </div>
        <div class="pro-list-empty" style="display: none">
            <img src="./images/ice%20cream/pro-list-empty.jpg" alt="没有。">
            <!-- <img src="/themes/site/img/pro-list-empty.jpg" alt="没有"> -->
            <span>没有。</span>
        </div>
    </div>
</div>
<input type="hidden" name="productId">
<input type="hidden" name="virtualCatId" value="19">
<div id="layer-box"></div>
<script>
	 $(function(){
		 doGetObjects();
		 $(".content-box").on("click",".pro-list-addcart",addCart);
	 })
	 //购物车方法
	 function addCart(){
	 	$(this).parents("li");
	 	//这个是绑定在数据库上的
	 	var data = $(this).parents("li").data("ct");
	 	//console.log($(this).parents("li").data("ct"));
	 	
	 	//通过Ajax 方法将数据传入数据库中
	 	var url="cart/addcart.do";
	 	var params ={
	 			name: data.name,
	 			username:"abc",
	 			price:data.price,
	 			category:data.category,
	 			number:data.number,
	 			imagesurl:data.image,
	 			totalprice:data.totalprice
	 			
	 	};
	 	
	 	$.post(url,params,function(result){
	 		alert(result.message);
	 	})
 	}
	 function doGetObjects(){
			//console.log(1)
			   var url="goods/dofindPageObjectsCategory.do";
			   //? 请问data函数的含义是什么？(从指定元素上获取绑定的数据)
			   //此数据会在何时进行绑定？(setPagination,doQueryObjects)
			   
			  
			 
			   var params={"category":"ice"};
			   //让此函数正在查询时可用
			 
			   //2.发起异步请求
			   //请问如下ajax请求的回调函数参数名可以是任意吗？可以,必须符合标识符的规范
		       $.getJSON(url,params,function(result){

		    	   doHandleResponseResult(result);
		    	  
				 }
			   );
		   
	 }
	 function doHandleResponseResult(result){
		   
		   if(result.state==1){
			  doSetTableBodyRows(result.data.records);
			 // console.log(result.data.goods)
			 
		   }else{
			  doSetTableBodyErrors(result.message);
		   }
	  
	 }
	 
	 function doSetTableBodyRows(goods){
		
		 //1.获取tbody对象，并清空对象
		   var tBody=$(".pro-list-pr");
		   tBody.empty();
		   //2.迭代records记录，并将其内容追加到tbody
		   for(var i in goods){
			  var li=$("<li></li>");
			   li.data("ct",goods[i]);
			  var img = doCreatedTds(goods[i]);
		 	  li.append(img)
		 	  tBody.append(li);
		   }

	 }
	 function doCreatedTds(row){
		   var tds= 
		   "<div class='pro-list-su'><a class='goods-list'>"+
		   "<img src='"+row.image+"'class='lazy' alt='芒果慕斯' style='display: inline;'>"+
		   "<h3>"+row.name+"</h3><span>¥"+row.price+"磅</span>"+
		   "</a><div class='label-entrance'><a href='javascript:void(0)'>"+
		   "儿童 &gt;</a><a href='javascript:void(0)'>聚会 &gt;</a>"+
		   "<a href='javascript:void(0)'>新品 &gt;</a></div><a href='javascript:void(0);'"+
		   " name='pro-list-addcart_21' class='pro-list-addcart' data-id='21'><i></i>加入购物车</a>"+
		   " </div> <div class='pro-specifications' data-id='21'></div>";
	      return tds;
	  } 

</script>
 