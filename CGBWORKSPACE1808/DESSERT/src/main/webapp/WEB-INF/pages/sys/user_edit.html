<!-- Horizontal Form -->
<div class="box box-info">
	<div class="box-header with-border">
		<h3 class="box-title">添加用户</h3>
	</div>
	<!-- /.box-header -->
	<!-- form start -->
	<form class="form-horizontal">
		<div class="box-body">
			<div class="form-group">
				<label for="usernameId" class="col-sm-2 control-label">用户名</label>
				<div class="col-sm-10">
					<input type="text" class="form-control" id="usernameId">
				</div>
			</div>
			<div class="form-group" id="pwdDiv">
				<label for="passwordId" class="col-sm-2 control-label">密码</label>
				<div class="col-sm-10">
					<input type="password" class="form-control" id="passwordId">
				</div>
			</div>
			<div class="form-group">
				<label for="emailId" class="col-sm-2 control-label">邮箱</label>
				<div class="col-sm-10">
					<input type="text" class="form-control" id="emailId">
				</div>
			</div>
			<div class="form-group">
				<label for="mobileId" class="col-sm-2 control-label">手机号</label>
				<div class="col-sm-10">
					<input type="text" class="form-control" id="mobileId">
				</div>
			</div>
			<div class="form-group">
				<label for="addressId" class="col-sm-2 control-label">地址</label>
				<div class="col-sm-10">
					<input type="text" class="form-control" id="addressId">
				</div>
			</div>
		</div>
		<!-- /.box-body -->
		<div class="box-footer">
			<button type="button" class="btn btn-default btn-cancel">Cancel</button>
			<button type="button" class="btn btn-info pull-right btn-save">Save</button>
		</div>
		<!-- /.box-footer -->
	</form>
</div>
<script type="text/javascript"
	src="bower_components/ztree/jquery.ztree.all.min.js"></script>
<script type="text/javascript" src="bower_components/layer/layer.js"></script>
<script type="text/javascript">
	$(function() {
		//事件注册
		$(".box-footer").on("click", ".btn-cancel", doCancel).on("click",
				".btn-save", doSaveOrUpdate);

		var data = $("#mainContentId").data("data");
		if (data)
			doInitEditFormData(data);
	});
	function doInitEditFormData(data) {
		$("#usernameId").val(data.username);
		$("#passwordId").val(data.password);
		$("#emailId").val(data.email);
		$("#mobileId").val(data.mobile);
		$("#addressId").val(data.address);
	}
	function doCancel() {
		$("#mainContentId").removeData("rowData");
		$("#mainContentId").load("user/doUserListUI.do");
	}
	function doSaveOrUpdate() {
		var rowData = $("#mainContentId").data("data");
		var params = doGetEditFormData();
		if (!params.username.trim()) {
			layer.alert("请输入用户名");
			return;
		}
		if (rowData)
			params.id = rowData.id;
		//2.发起异步请求
		var insertUrl = "user/doSaveObject.do";
		var updateUrl = "user/doUpdateObject.do";
		var url = rowData ? updateUrl : insertUrl;
		$.post(url, params, function(result) {
			if (result.state == 1) {
				layer.alert(result.message);
				doCancel();
			} else {
				layer.alert(result.message);
			}
		})
	}
	function doGetEditFormData() {
		//获取用户输入的数据
		var params = {
			username : $("#usernameId").val(),
			password : $("#passwordId").val(),
			email : $("#emailId").val(),
			mobile : $("#mobileId").val(),
			address : $("#addressId").val()
		}
		return params;
	}
</script>